(globalThis.webpackChunk_openmrs_esm_patient_programs_app=globalThis.webpackChunk_openmrs_esm_patient_programs_app||[]).push([[461],{5351:(e,r,t)=>{"use strict";t.d(r,{Z:()=>i});var n=t(272),a=t.n(n),o=t(2609),l=t.n(o)()(a());l.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-programs__programs-detailed-summary__widgetCard___R5Btc{border:1px solid #e0e0e0}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/programs/programs-detailed-summary.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCrDF,sEACE,wBAAA",sourceRoot:""}]),l.locals={widgetCard:"-esm-patient-programs__programs-detailed-summary__widgetCard___R5Btc"};const i=l},6983:(e,r,t)=>{"use strict";t.d(r,{Z:()=>i});var n=t(272),a=t.n(n),o=t(2609),l=t.n(o)()(a());l.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-programs__programs-overview__widgetCard___yEo1t{border:1px solid #e0e0e0}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/programs/programs-overview.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCrDF,8DACE,wBAAA",sourceRoot:""}]),l.locals={widgetCard:"-esm-patient-programs__programs-overview__widgetCard___yEo1t"};const i=l},7461:(e,r,t)=>{"use strict";t.r(r),t.d(r,{importTranslation:()=>M,programsDashboardLink:()=>q,programsDetailedSummary:()=>U,programsForm:()=>J,programsOverview:()=>W,startupApp:()=>$});var n=t(2870),a=t(4556),o={hideAddProgramButton:{_type:n.Type.Boolean,_default:!1}},l=t(268),i=t.n(l),s=t(2779),c=t.n(s),u=t(4924),d=t(9341),m=t(6759),p=t(4076),g=t(321),f=t.n(g),v=t(1195),b=t.n(v),y=t(3275),h=t.n(y),E=t(7162),O=t.n(E),P=t(2094),w=t.n(P),A=t(757),C=t.n(A),k=t(6983),j={};j.styleTagTransform=C(),j.setAttributes=O(),j.insert=h().bind(null,"head"),j.domAPI=b(),j.insertStyleElement=w(),f()(k.Z,j);const _=k.Z&&k.Z.locals?k.Z.locals:void 0;function S(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Z(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){S(e,r,t[r])}))}return e}var D=t(7631),T=t(5351),L={};L.styleTagTransform=C(),L.setAttributes=O(),L.insert=h().bind(null,"head"),L.domAPI=b(),L.insertStyleElement=w(),f()(T.Z,L);const x=T.Z&&T.Z.locals?T.Z.locals:void 0;function I(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function B(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){I(e,r,t[r])}))}return e}function N(e){var r=e.programEnrollmentId,t="tablet"===(0,n.useLayoutType)(),o=(0,u.useTranslation)().t,l=i().useCallback((function(){return(0,a.launchPatientWorkspace)("programs-form-workspace",{programEnrollmentId:r})}),[r]);return i().createElement(d.zxk,{"aria-label":"edit program",kind:"ghost",renderIcon:function(e){return i().createElement(D.I8,B({size:16},e))},iconDescription:o("editProgram","Edit Program"),onClick:l,hasIconOnly:!0,tooltipPosition:"left",size:t?"lg":"sm"})}function F(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var H="@openmrs/esm-patient-programs-app",z={featureName:"patient-programs",moduleName:H},M=t(3979);function $(){(0,n.defineConfigSchema)(H,o)}var R,V,W=(0,n.getSyncLifecycle)((function(e){e.basePath;var r=e.patientUuid,t=(0,u.useTranslation)().t,o=(0,n.useConfig)(),l=t("programs","Program enrollments"),s=t("carePrograms","Care Programs"),g=t("seeAll","See all"),f="${openmrsSpaBase}/patient/".concat(r,"/chart/Programs"),v=(0,n.useLayoutType)(),b="tablet"===v,y=(0,n.isDesktop)(v),h=(0,p.b$)(r),E=h.activeEnrollments,O=h.availablePrograms,P=h.eligiblePrograms,w=h.enrollments,A=h.isError,C=h.isLoading,k=h.isValidating,j=(0,n.usePagination)(null!=w?w:[],5),S=j.results,D=j.goTo,T=j.currentPage,L=i().useCallback((function(){return(0,a.launchPatientWorkspace)("programs-form-workspace")}),[]),x=[{key:"display",header:t("activePrograms","Active programs")},{key:"location",header:t("location","Location")},{key:"dateEnrolled",header:t("dateEnrolled","Date enrolled")},{key:"status",header:t("status","Status")},{key:"actions",header:t("actions","Actions")}],I=i().useMemo((function(){return null==S?void 0:S.map((function(e){var r,a;return{id:e.uuid,display:e.display,location:null!==(a=null===(r=e.location)||void 0===r?void 0:r.display)&&void 0!==a?a:"--",dateEnrolled:e.dateEnrolled?(0,n.formatDatetime)(new Date(e.dateEnrolled)):"--",status:e.dateCompleted?"".concat(t("completedOn","Completed On")," ").concat((0,n.formatDate)(new Date(e.dateCompleted))):t("active","Active")}}))}),[S,t]);return C?i().createElement(d.gqd,{role:"progressbar",compact:y,zebra:!0}):A?i().createElement(a.ErrorState,{error:A,headerTitle:s}):(null==E?void 0:E.length)?i().createElement("div",{className:_.widgetCard},i().createElement(a.CardHeader,{title:s},i().createElement("span",null,k?i().createElement(d.lSo,null):null),o.hideAddProgramButton?null:i().createElement(d.zxk,{kind:"ghost",renderIcon:function(e){return i().createElement(m.mm,Z({size:16},e))},iconDescription:"Add programs",onClick:L,disabled:(null==O?void 0:O.length)&&0===(null==P?void 0:P.length)},t("add","Add"))),(null==O?void 0:O.length)&&0===(null==P?void 0:P.length)&&i().createElement(d.K0D,{style:{minWidth:"100%",margin:"0rem",padding:"0rem"},kind:"info",lowContrast:!0,subtitle:t("noEligibleEnrollments","There are no more programs left to enroll this patient in"),title:t("fullyEnrolled","Enrolled in all programs")}),i().createElement(d.wQF,{rows:I,headers:x,isSortable:!0,size:b?"lg":"sm",useZebraStyles:!0},(function(e){var r=e.rows,t=e.headers,n=e.getHeaderProps,a=e.getTableProps;return i().createElement(d.xJi,null,i().createElement(d.iA_,Z({"aria-label":"programs overview"},a()),i().createElement(d.ssF,null,i().createElement(d.SCH,null,t.map((function(e){var r,t;return i().createElement(d.xDH,Z({className:c()(_.productiveHeading01,_.text02)},n({header:e,isSortable:e.isSortable})),null!==(t=null===(r=e.header)||void 0===r?void 0:r.content)&&void 0!==t?t:e.header)})))),i().createElement(d.RMI,null,r.map((function(e){return i().createElement(d.SCH,{key:e.id},e.cells.map((function(e){var r,t;return i().createElement(d.pj1,{key:e.id},null!==(t=null===(r=e.value)||void 0===r?void 0:r.content)&&void 0!==t?t:e.value)})))})))))})),i().createElement(a.PatientChartPagination,{currentItems:S.length,onPageNumberChange:function(e){var r=e.page;return D(r)},pageNumber:T,pageSize:5,totalItems:null==w?void 0:w.length,dashboardLinkUrl:f,dashboardLinkLabel:g})):i().createElement(a.EmptyState,{displayText:l,headerTitle:s,launchForm:L})}),z),U=(0,n.getSyncLifecycle)((function(e){var r=e.patientUuid,t=(0,u.useTranslation)().t,o=(0,n.useLayoutType)(),s="tablet"===o,g=(0,n.isDesktop)(o),f=(0,n.useConfig)().hideAddProgramButton,v=t("programEnrollments","Program enrollments"),b=t("carePrograms","Care Programs"),y=(0,p.b$)(r),h=y.enrollments,E=y.isLoading,O=y.isError,P=y.isValidating,w=y.availablePrograms,A=y.eligiblePrograms,C=(0,l.useMemo)((function(){return[{key:"display",header:t("activePrograms","Active programs")},{key:"location",header:t("location","Location")},{key:"dateEnrolled",header:t("dateEnrolled","Date enrolled")},{key:"status",header:t("status","Status")}]}),[t]),k=(0,l.useMemo)((function(){return null==h?void 0:h.map((function(e){var r,a;return{id:e.uuid,display:e.display,location:null!==(a=null===(r=e.location)||void 0===r?void 0:r.display)&&void 0!==a?a:"--",dateEnrolled:(0,n.formatDatetime)(new Date(e.dateEnrolled)),status:e.dateCompleted?"".concat(t("completedOn","Completed On")," ").concat((0,n.formatDate)(new Date(e.dateCompleted))):t("active","Active")}}))}),[h,t]),j=(0,l.useCallback)((function(){return(0,a.launchPatientWorkspace)("programs-form-workspace")}),[]);return E?i().createElement(d.gqd,{role:"progressbar",compact:g,zebra:!0}):O?i().createElement(a.ErrorState,{error:O,headerTitle:b}):(null==h?void 0:h.length)?i().createElement("div",{className:x.widgetCard},i().createElement(a.CardHeader,{title:b},i().createElement("span",null,P?i().createElement(d.lSo,null):null),f?null:i().createElement(d.zxk,{kind:"ghost",renderIcon:function(e){return i().createElement(m.mm,B({size:16},e))},iconDescription:"Add programs",onClick:j,disabled:(null==w?void 0:w.length)&&0===(null==A?void 0:A.length)},t("add","Add"))),(null==w?void 0:w.length)&&0===(null==A?void 0:A.length)?i().createElement(d.K0D,{style:{minWidth:"100%",margin:"0rem",padding:"0rem"},kind:"info",lowContrast:!0,subtitle:t("noEligibleEnrollments","There are no more programs left to enroll this patient in"),title:t("fullyEnrolled","Enrolled in all programs")}):null,i().createElement(d.wQF,{rows:k,headers:C,isSortable:!0,size:s?"lg":"sm",useZebraStyles:!0},(function(e){var r=e.rows,t=e.headers,n=e.getHeaderProps,a=e.getTableProps;return i().createElement(d.xJi,null,i().createElement(d.iA_,B({"aria-label":"program enrollments"},a()),i().createElement(d.ssF,null,i().createElement(d.SCH,null,t.map((function(e){var r,t;return i().createElement(d.xDH,B({className:c()(x.productiveHeading01,x.text02)},n({header:e,isSortable:e.isSortable})),null!==(t=null===(r=e.header)||void 0===r?void 0:r.content)&&void 0!==t?t:e.header)})),i().createElement(d.xDH,null))),i().createElement(d.RMI,null,r.map((function(e,r){var t;return i().createElement(d.SCH,{key:e.id},e.cells.map((function(e){var r,t;return i().createElement(d.pj1,{key:e.id},null!==(t=null===(r=e.value)||void 0===r?void 0:r.content)&&void 0!==t?t:e.value)})),i().createElement(d.pj1,{className:"cds--table-column-menu"},i().createElement(N,{programEnrollmentId:null===(t=h[r])||void 0===t?void 0:t.uuid})))})))))}))):i().createElement(a.EmptyState,{displayText:v,headerTitle:b,launchForm:j})}),z),q=(0,n.getSyncLifecycle)((0,a.createDashboardLink)((R=function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){F(e,r,t[r])}))}return e}({},{slot:"patient-chart-programs-dashboard-slot",columns:1,path:"Programs",title:"Programs"}),V=null!=(V={moduleName:H})?V:{},Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(V)):function(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(V)).forEach((function(e){Object.defineProperty(R,e,Object.getOwnPropertyDescriptor(V,e))})),R)),z),J=(0,n.getAsyncLifecycle)((function(){return Promise.all([t.e(940),t.e(649)]).then(t.bind(t,6649))}),z)},4076:(e,r,t)=>{"use strict";t.d(r,{Bw:()=>d,YX:()=>g,b$:()=>f,df:()=>p,oI:()=>m});var n=t(3255),a=t(2870),o=t(4221),l=t(9626),i=t(3139),s=t(6772);function c(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var u="custom:(uuid,display,program,dateEnrolled,dateCompleted,location:(uuid,display))";function d(e){var r,t="/ws/rest/v1/programenrollment?patient=".concat(e,"&v=").concat(u),l=(0,n.ZP)(e?t:null,a.openmrsFetch),i=l.data,s=l.error,c=l.isLoading,d=l.isValidating,m=l.mutate,p=(null==i||null===(r=i.data)||void 0===r?void 0:r.results.length)>0?null==i?void 0:i.data.results.sort((function(e,r){return r.dateEnrolled>e.dateEnrolled?1:-1})):null,g=null==p?void 0:p.filter((function(e){return!e.dateCompleted}));return{data:i?(0,o.Z)(p,(function(e){var r;return null==e||null===(r=e.program)||void 0===r?void 0:r.uuid})):null,isError:s,isLoading:c,isValidating:d,activeEnrollments:g,mutateEnrollments:m}}function m(e){var r,t,o=(0,n.ZP)("/ws/rest/v1/program?v=custom:(uuid,display,allWorkflows,concept:(uuid,display))",a.openmrsFetch),c=o.data,u=o.error,d=o.isLoading,m=null!==(t=null==c||null===(r=c.data)||void 0===r?void 0:r.results)&&void 0!==t?t:null;return{data:m,isError:u,isLoading:d,eligiblePrograms:(0,l.Z)(m,(function(r){return!(0,i.Z)((0,s.Z)(e,"program.uuid"),r.uuid)}))}}function p(e,r){if(!e)return null;var t=e.program,n=e.patient,o=e.dateEnrolled,l=e.dateCompleted,i=e.location;return(0,a.openmrsObservableFetch)("/ws/rest/v1/programenrollment",{method:"POST",headers:{"Content-Type":"application/json"},body:{program:t,patient:n,dateEnrolled:o,dateCompleted:l,location:i},signal:r.signal})}function g(e,r,t){if(!r&&!r.program)return null;r.program;var n=r.dateEnrolled,o=r.dateCompleted,l=r.location;return(0,a.openmrsObservableFetch)("/ws/rest/v1/programenrollment/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:{dateEnrolled:n,dateCompleted:o,location:l},signal:t.signal})}var f=function(e){var r,t,n=d(e),a=n.data,o=n.isError,l=n.isLoading,i=n.isValidating,s=n.activeEnrollments,u=m(a),p=u.data,g=u.eligiblePrograms;return r=function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){c(e,r,t[r])}))}return e}({enrollments:a},{isLoading:l,isError:o}),t=null!=(t={isValidating:i,activeEnrollments:s,availablePrograms:p,eligiblePrograms:g})?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):function(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})),r}},3979:(e,r,t)=>{var n={"./am.json":[8788,788],"./ar.json":[4460,460],"./en.json":[3574,574],"./es.json":[8319,319],"./fr.json":[2757,757],"./he.json":[5833,833],"./km.json":[7807,807]};function a(e){if(!t.o(n,e))return Promise.resolve().then((()=>{var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}));var r=n[e],a=r[0];return t.e(r[1]).then((()=>t(a)))}a.keys=()=>Object.keys(n),a.id=3979,e.exports=a},506:(e,r,t)=>{"use strict";t.d(r,{Z:()=>l});const n=function(e,r,t){for(var n=-1,a=Object(e),o=t(e),l=o.length;l--;){var i=o[++n];if(!1===r(a[i],i,a))break}return e};var a=t(4753);var o=t(3282);const l=(i=function(e,r){return e&&n(e,r,a.Z)},function(e,r){if(null==e)return e;if(!(0,o.Z)(e))return i(e,r);for(var t=e.length,n=-1,a=Object(e);++n<t&&!1!==r(a[n],n,a););return e});var i},9626:(e,r,t)=>{"use strict";t.d(r,{Z:()=>s});var n=t(2300),a=t(506);const o=function(e,r){var t=[];return(0,a.Z)(e,(function(e,n,a){r(e,n,a)&&t.push(e)})),t};var l=t(1426),i=t(7885);const s=function(e,r){return((0,i.Z)(e)?n.Z:o)(e,(0,l.Z)(r,3))}},3139:(e,r,t)=>{"use strict";t.d(r,{Z:()=>P});var n=t(1721),a=t(3282),o=t(8147),l=t(7885),i=t(3391);var s=/\s/;var c=/^\s+/;const u=function(e){return e?e.slice(0,function(e){for(var r=e.length;r--&&s.test(e.charAt(r)););return r}(e)+1).replace(c,""):e};var d=t(3122),m=t(2758),p=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,f=/^0o[0-7]+$/i,v=parseInt;const b=function(e){return e?Infinity===(e=function(e){if("number"==typeof e)return e;if((0,m.Z)(e))return NaN;if((0,d.Z)(e)){var r="function"==typeof e.valueOf?e.valueOf():e;e=(0,d.Z)(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=u(e);var t=g.test(e);return t||f.test(e)?v(e.slice(2),t?2:8):p.test(e)?NaN:+e}(e))||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var y=t(5598);var h=t(4753);const E=function(e){return null==e?[]:function(e,r){return(0,y.Z)(r,(function(r){return e[r]}))}(e,(0,h.Z)(e))};var O=Math.max;const P=function(e,r,t,s){e=(0,a.Z)(e)?e:E(e),t=t&&!s?function(e){var r=b(e),t=r%1;return r==r?t?r-t:r:0}(t):0;var c=e.length;return t<0&&(t=O(c+t,0)),function(e){return"string"==typeof e||!(0,l.Z)(e)&&(0,i.Z)(e)&&"[object String]"==(0,o.Z)(e)}(e)?t<=c&&e.indexOf(r,t)>-1:!!c&&(0,n.Z)(e,r,t)>-1}},6772:(e,r,t)=>{"use strict";t.d(r,{Z:()=>c});var n=t(5598),a=t(1426),o=t(506),l=t(3282);const i=function(e,r){var t=-1,n=(0,l.Z)(e)?Array(e.length):[];return(0,o.Z)(e,(function(e,a,o){n[++t]=r(e,a,o)})),n};var s=t(7885);const c=function(e,r){return((0,s.Z)(e)?n.Z:i)(e,(0,a.Z)(r,3))}}}]);